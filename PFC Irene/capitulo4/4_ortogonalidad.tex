
Los sistemas MIMO masivo nos permiten desplegar un elevado número de elementos en, al menos, uno de los dos extremos de la comunicación. Uno de los aspectos clave que hace posible esta tecnología es que la matriz de canal $\miH$ sea lo más ortogonal posible para simplificar así el procesado de señal. Dado que en este caso no estamos en escenarios con matrices de canal i.i.d. donde las matrices serían ortogonales, debemos encontrar una forma de medir esta ortogonalidad en los casos con los que estamos trabajando. En estos escenarios las premisas de las que partimos no son ideales sino que tienen múltiples limitaciones como un espacio limitado para el despliegue de las antenas o características del canal no deseadas.

Como ya hemos dicho nuestro interés reside en simplificar el procesado de señal, uno de los cuellos de botella de los sistemas MIMO masivo debido a la complejidad del algoritmo asociado. El aspecto clave que hace posible esta simplificación (que se traduce en una simplificación del precodificador y el ecualizador) es la ortogonalidad. Si las filas o las columnas de la matriz de canal $\miH$ son ortogonales, será posible hacer uso de una estrategia de filtro adaptado en el transmisor y receptor. 

% *****************************************************************************************************************************
\section{Medidas de ortogonalidad}

Una matriz $\miA$ se dice que sus filas son ortogonales si
\begin{equation}
	\miA \miA^H = \mathbf{I}
\end{equation}
o que sus columnas son ortogonales si
\begin{equation}
	\miA^H \miA = \mathbf{I}
\end{equation}
que se traduce en
\begin{equation}
	\miA^{-1} = \miA^H
\end{equation}
donde $\miA^H$ es la matriz transpuesta, e $\mathbf{I}$ es la matriz identidad. Esta propiedad hace que trabajar con matrices ortogonales sea especialmente fácil, ya que hallar la matriz transpuesta de $\miA$ es mucho más sencillo que hallar su inversa. 

Volviendo a nuestro escenario, en el que el canal queda definido por la matriz $\miH$, lo que buscamos es que esta matriz sea lo más ortogonal posible, dado que esto simplificaría enormemente el procesamiento de señal. Sabiendo que el lugar más factible para desplegar muchas antenas es la BS (estación base), podemos diseñar un precodificador o un ecualizador muy simple para el caso del enlace descendente o ascendente, respectivamente. En ambos casos sería un filtro adaptado. 

Nos centraremos en el caso del enlace descendente, por lo que matemáticamente la propiedad que buscamos en nuestra matriz de canal $\miH$ es
\begin{equation}
	\frac{\miH\miH^H}{M}\approx \mathbf{I}_N
\end{equation}
es decir, buscamos que las filas de $\miH$ sean ortogonales. 

%\begin{Triple máximo}
Cada elemento $h_{nm}$ caracteriza el canal existente entre la antena $m$-ésima transmisora y la antena $n$-ésima receptora; cada fila entonces de la matriz $\miH$ caracterizará el canal entre las $M$ antenas transmisoras y la antena $n$-ésima receptora. Nos interesa que cada fila $[h_{1m}\text{ }  h_{2m}\text{ }... \text{ }h_{NM}]$ sea ortogonal al resto de filas, es decir, independiente a las comunicaciones que viajan a otra antena receptora. 
%\end{Triple máximo}

Para medir el nivel de ortogonalidad de la matriz $\miH$, es necesario definir una medida para esta magnitud. Proponemos a continuación varias medidas con las que hemos trabajado, para después concluir con la que nos parece más adecuada y por qué. Para evaluar su comportamiento lo haremos observando los resultados de las medidas explicadas a continuación comparando en cada caso el comportamiento para las matrices de canal $M \times 2$, $M \times 4$, $M \times M$ e i.i.d.

\subsection{Norma de Frobenius}\label{theo_frobenius}

En este primer caso, utilizamos el concepto de norma matricial (Anexo \ref{anexo}) y en particular el caso concreto de normas componente a componente, definidas como:
\begin{equation}
	{\left\|A\right\|}_p = \left(\sum_{i = 1}^{M}\sum_{j = 1}^{N}|a_{ij}|^p\right)^{1/p}
\end{equation}
Para $p = 2$, a esto se le llama norma de Frobenius o norma de Hilbert-Schmidt. La norma de Frobenius es una norma matricial que se define como la raíz cuadrada de la suma de los valores absolutos de los elementos que forman la matriz $\miA$ de dimensiones $M \times N$
\begin{equation}
	{\left\|A\right\|}_F = \sqrt{\sum_{i = 1}^{M}{\sum_{j = 1}^{N}|a_{ij}|^2}}
\end{equation}
La norma de Frobenius también equivale a la raíz cuadrada de la traza de la matriz $\miA\miA^H$, donde $\miA^H$ es la matriz transpuesta conjugada, 
\begin{equation}
	{\left\|A\right\|}_F = \sqrt{Tr(\miA\miA^H)}
\end{equation}

Utilizaremos esta norma para calcular la distancia que existe entre la matriz $\frac{\miH\miH^H}{M}$ y la matriz identidad $\mathbf{I}_N$. Definimos así nuestra medida como

\begin{equation}
d\left(\frac{\miH\miH^H}{M}, \mathbf{I}_N\right) = {\left \|   \frac{\miH\miH^H}{M} - \mathbf{I}_N  \right\|}_F
\end{equation}


\subsection{Defecto de ortogonalidad }\label{theo_lattice}

El defecto de ortogonalidad es una medida de lo cerca que está una matriz de ser ortogonal, partiendo del concepto de bases de vectores ortogonales que forman un espacio. Compara el producto de la longitud de los vectores que forman la base con el volumen del paralelepípedo que definen. Para una base formada por vectores perfectamente ortogonales, estas dos cantidades deberían ser iguales. 

Cualquier base de $n$ vectores puede ser representada por la matriz $\miA$, cuyas columnas son los vectores de la base $a_i, i = 1, ..., n$. Cuando el número de vectores que forman la base es igual a la dimensión del espacio que ocupan, la matriz $\miA$ es cuadrada, y el volumen del paralelepípedo es simplemente el valor absoluto del determinante de la matriz, $\det(\miA)$. Si el número de vectores de la base es menor a la dimensión del espacio, el volumen queda definido por $\sqrt{\det(\miA^H\miA)}$. 

Se define entonces el defecto de ortogonalidad como
\begin{equation}
	\delta(\miA) = \frac{\prod_{i = 1}^{n}\|a_i\|}{\sqrt{det(\miA^H\miA)}}
\end{equation}

De la definición geométrica se deriva que $\delta(\miA) \geq  1$ y únicamente en el caso de que la base sea ortogonal tendremos $\delta(\miA) = 1$. 

Nosotros aplicaremos esta medida a nuestra matriz de canal $\miH$, buscando ortogonalidad en las filas por lo que la expresión final queda de la siguiente forma:
%%%%%-----mMIRAAAAAAAAAAR!!!!!
\begin{equation}
	\delta(\miA) = \frac{\prod_{i = 1}^{n}\|h_i\|}{\sqrt{det(\miH\miH^H)}}
\end{equation}

donde $\|h_i\|$ son las filas de $\miH$.


\subsection{Norma del producto de las filas}\label{theo_prod}

En tercer lugar, hemos hecho uso de la propiedad de que el producto escalar de dos vectores ortogonales es nulo. Si una matriz $\miA$ tiene las columnas ortogonales, el producto de una columna por cualquier otra será también cero. 

Así, hemos definido la siguiente medida de ortogonalidad que calcula la suma de los valores absolutos del producto de una fila por el resto (recordemos que nosotros buscamos que las filas de $\miH$ sean ortogonales)
\begin{equation}
	\Lambda = \sum_{i = 1}^{N}\sum_{j = 1\\j \neq i}^N |a_i^Ha_j|
\end{equation}

De esta forma, cuanto más cerca de 0 esté $\Lambda$ más cerca estaremos de la ortogonalidad

\subsection{Elección de la medida de ortogonalidad más adecuada}

Para escoger la medida que más se adapta a lo que buscamos, compararemos los resultados que nos ofrece cada una de ellas para diferentes casos i.i.d.. Para un número $M$ concreto de antenas en el transmisor, obtendremos los resultados de ortogonalidad con $2$, $4$ o $M$ antenas en el receptor. 

En primer lugar, en la tabla (\ref{tabla_frobe}) se puede observar el comportamiento de la \textbf{norma de Frobenius} (detallada en la sección \ref{theo_frobenius})para el caso de $M = 50$ y diferentes antenas en el receptor. 

\begin{table}[htb]
\centering
\begin{tabular}{|c|c|}
  \hline
  \multicolumn{2}{|c|}{Norma de Frobenius para $M = 50$} \\
  \hline
  $N = 2$ & 0.2625 \\
  $N = 4$ & 0.5530 \\
  $N = 50$ & 7.0633 \\
  \hline
\end{tabular}
\caption{Valores de la norma de Frobenius para el caso de matrices i.i.d. con 50 antenas en el transmisor y 2, 4 y 50 antenas en el receptor}
\label{tabla_frobe}
\end{table}


Intuitivamente, se podría creer que el nivel de ortogonalidad que deberíamos obtener para todas las matrices i.i.d debería ser el mismo pero como vemos en las gráficas no lo es. Para entender esta propiedad basta con observar que calcular la norma de Frobenius de matriz se reduce a calcular la suma de los valores absolutos de cada elemento de la matriz. Una matriz de mayor tamaño tendrá más elementos y por tanto su norma de Frobenius será necesariamente mayor. Es por esto que los valores correspondientes a los casos de 50x2 o 50x4 se encuentran próximos a cero pero el de 50x50 se encuentra por encima, alrededor de un valor de 7. 

En cuanto al \textbf{defecto de ortogonalidad} explicado en la sección \ref{theo_lattice}, en la tabla \ref{tabla_lattice} encontramos los valores que arroja esta medida para los mismos casos evaluados con la norma de Frobenius. De nuevo para $N = 2$ y $N = 4$ obtenemos valores muy bajos pero, con $N = 50$, el resultado se dispara enormemente. 

\begin{table}[htb]
\centering
\begin{tabular}{|c|c|}
  \hline
  \multicolumn{2}{|c|}{Defecto de ortogonalidad para $M = 50$} \\
  \hline
  $N = 2$ & 1.0386 \\
  $N = 4$ & 1.2740\\
  $N = 50$ & 3.9085 x $10^{30}$ \\
  \hline
\end{tabular}
\caption{Valores del defecto de ortogonalidad para el caso de matrices i.i.d. con 50 antenas en el transmisor y 2, 4 y 50 antenas en el receptor}
\label{tabla_lattice}
\end{table}

Por último, en cuanto a la tercera medida comentada en la sección \ref{theo_prod}, los valores obtenidos los podemos encontrar el la tabla \ref{tabla_producto}. Pese a que el valor obtenido para $N = 2$ es muy bajo, el crecimiento que sufre esta medida con respecto a $N$ es bastante rápido, y ya para $N = 4$ nuestra medida nos ofrece un resultado de 3.0936. En el caso de $N = 50$ el aumento de este valor es muy grande, alcanzando el valor de 955.8792. Dado que nuestra matriz $\miH$ (i.i.d. en este caso) ha sido generada de forma aleatoria, la probabilidad de que dos filas de $\miH$ sean independientes es mucho más alta que la probabilidad de que 50 filas lo sean, y de ahí que el resultado que nos da la medida de ortogonalidad para dimensiones elevadas sea mucho mayor y, por tanto, denote menor ortogonalidad

\begin{table}[htb]
\centering
\begin{tabular}{|c|c|}
  \hline
  \multicolumn{2}{|c|}{Producto de filas para $M = 50$} \\
  \hline
  $N = 2$ & 0.4999 \\
  $N = 4$ & 3.0936\\
  $N = 50$ & 955.8792\\
  \hline
\end{tabular}
\caption{Valores del producto de filas para el caso de matrices i.i.d. con 50 antenas en el transmisor y 2, 4 y 50 antenas en el receptor}
\label{tabla_producto}
\end{table}

Una vez comparados los resultados de las tres medidas de ortogonalidad propuestas, estamos ya en condiciones de seleccionar aquella que más se adapta a lo que buscamos para realizar las simulaciones. Nuestro objetivo es encontrar aquella medida que nos dé resultados similares de ortogonalidad para los tres casos i.i.d. estudiados. En los tres escenarios observamos cómo los valores para los casos de dimensiones reducidas ($N = 2$ y $N = 4$) son suficientemente bajos, aumentando a medida que las dimensiones aumentan. De las tres medidas analizadas, aquella que sufre un crecimiento menor con respecto a la dimensión es la norma de Frobenius, por lo que la elegiremos como la más adecuada y haremos uso de ella en las simulaciones sucesivas. Además, esta medida de ortogonalidad es consistente con la que se propone en \cite{tensor}




% *****************************************************************************************************************************

\section{Resultados de ortogonalidad de las simulaciones}\label{cap:seccion_simul}

\subsection{Parámetros de las simulaciones}

Los parámetros que emplearemos en estas simulaciones serán los mismos que describimos en la sección \ref{sec:param}.


\subsection{Ortogonalidad en el caso asimétrico $N = 2$}\label{cap:orto_N2}

Se muestran en esta sección los resultados de ortogonalidad obtenidos para un escenario en el que $N = 2$. Para ello, asumimos un escenario incorrelado en el receptor que podría tratarse o bien en un sistema MIMO multiusuario en el que la BS sirve a 2 usuarios o bien en un sistema de un único usuario con 2 antenas en el receptor. 

En la figura (\ref{fig:orto2}) podemos observar el efecto que produce la distancia entre antenas transmisoras $d_t$ en la ortogonalidad de $\miH$. En ellas se puede ver cómo a mayor distancia entre antenas mejor es el nivel de ortogonalidad obtenido, lo que deriva inevitablemente en la necesidad de mayor espacio físico para el despliegue de las antenas. 

\begin{figure}[htbp]
\centering
	\mbox{ \subfigure[$ASD = 5^\circ$]{\resizebox{!}{7cm}		{\includegraphics{figuras/orto_barridoM_N2_ASD5}}}}
	\mbox{ \subfigure[$ASD =10^\circ$]{\resizebox{!}{7cm}		{\includegraphics{figuras/orto_barridoM_N2_ASD10}}}}
	\mbox{ \subfigure[$ASD =20^\circ$]{\resizebox{!}{7cm}		{\includegraphics{figuras/orto_barridoM_N2_ASD20}}}}
	\caption{Medida de ortogonalidad para un sistema MIMO masivo con $M$ antenas transmisoras y $2$ antenas receptoras para diferentes valores de $d_t$.}
	\label{fig:orto2}
\end{figure}

Además, podemos observar un efecto de saturación en las gráficas en relación al valor de $M$. Llega un punto en el que la mejora que provoca un aumento del número de antenas en transmisión ($M$) es mínima. A valores bajos de $M$, aumentar el número de antenas transmisoras mejora significativamente la ortogonalidad de la matriz. Para valores elevados, a partir de entre 50 y 60 antenas transmisoras, esta mejora no es significativa y probablemente habría que analizar el coste físico del despliegue del sistema para estudiar si merecería la pena incluir tantas antenas. Este efecto se hace más pronunciado cuanto mayor es el valor de ASD, es decir, cuando nos encontramos en condiciones más favorables antes aparece el efecto de saturación. A medida que disminuye ASD, las matrices realistas tienden de forma más lenta a una mayor ortogonalidad y existe mayor distancia entre la medida calculada a diferentes valores de $d_t$ (por ejemplo, la diferencia que existe en la ortogonalidad para la matriz correspondiente a $d_t = 0.75\lambda$ y a $dt_t = \lambda$ es mayor para $ASD = 5^\circ$ que para $ASD = 20^\circ$). 

\begin{figure}[htbp]
\centering
	\mbox{ \subfigure[$d_t = 0.5\lambda$]{\resizebox{!}{7cm}		{\includegraphics{figuras/orto_barridoM_N2_dt05}}}}
	\mbox{ \subfigure[$d_t = \lambda$]{\resizebox{!}{7cm}		{\includegraphics{figuras/orto_barridoM_N2_dt1}}}}
	\mbox{ \subfigure[$d_t = 2\lambda$]{\resizebox{!}{7cm}		{\includegraphics{figuras/orto_barridoM_N2_dt2}}}}
	\caption{Medida de ortogonalidad para un sistema MIMO masivo con $M$ antenas transmisoras y $2$ antenas receptoras para diferentes valores de $ASD$.}
	\label{fig:orto2_dt}
\end{figure}


De la figura (\ref{fig:orto2_dt}) que muestra el comportamiento de la ortogonalidad de $\miH$ con respecto a diferentes valores de ASD, podemos extraer conclusiones similares. Al igual que antes preferíamos casos en los que la distancia entre antenas transmisoras fuera lo mayor posible, también ahora nos interesa un valor de ASD lo mayor posible. Cuanto más pequeña sea la dispersión angular, la distancia obtenida entre $\miH$ y la matriz identidad será mayor y por tanto, nuestra $\miH$ será menos ortogonal. 

De nuevo aparece el efecto de saturación ya comentado anteriormente. Para valores pequeños de $M$, añadir más antenas en el transmisor mejora significativamente la ortogonalidad. No sucede esto mismo a partir de valores elevados de $M$ (alrededor de 50 o 60), cuando se produce este efecto de saturación y no mejora demasiado la ortogonalidad. Dicho efecto sucede antes para valores altos de $d_t$. 

\subsection{Ortogonalidad en el caso asimétrico $N = 4$}

Continuando en un escenario MIMO masivo con $M$ antenas en transmisión y $N = 4$ antenas en recepción, las simulaciones en este caso nos arrojan comportamientos de la matriz $\miH$ prácticamente idénticos a los obtenidos para $N = 2$. Para ilustrarlo, sólo incluiremos la gráfica (\ref{fig:orto4}) que muestra los resultados para $ASD = 10^\circ$ y $d_t = \lambda$. 

En estas gráficas podemos ver cómo la evolución que sufre la ortogonalidad de la matriz $\miH$ es tal y como ya hemos descrito en la sección \ref{cap:orto_N2} para el caso de 2 antenas en el receptor. La ortogonalidad aumenta a medida que el ángulo de dispersión en el transmisor y la distancia entre antenas transmisoras disminuyen. Como es de esperar, también observamos el efecto de saturación que se produce cuando nos encontramos con un número de antenas elevado. 

%olmo es muy guapo y muy bueno

\begin{figure}[htbp]
\centering
	\mbox{ \subfigure[$ASD = 10^\circ$]{\resizebox{!}{10cm}		{\includegraphics{figuras/orto_barridoM_N4_ASD10}}}}
	\mbox{ \subfigure[$d_t = \lambda$]{\resizebox{!}{10cm}		{\includegraphics{figuras/orto_barridoM_N4dt1}}}}
	\caption{Medida de ortogonalidad para un sistema MIMO masivo con $M$ antenas transmisoras y $4$ antenas receptoras para diferentes valores de $ASD$ y $d_t$.}
	\label{fig:orto4}
\end{figure}




\subsection{Ortogonalidad en el caso simétrico $N = M$}

Para el caso de sistemas MIMO simétricos, con igual número de antenas receptoras que transmisoras ($M = N$), los resultados obtenidos son los que aparecen en la figura (\ref{fig:ortoN}). 

\begin{figure}[htbp]
\centering
	\mbox{ \subfigure[$ASD = 10^\circ$]{\resizebox{!}{10cm}		{\includegraphics{figuras/orto_barridoM_NM_ASD10}}}}
	\mbox{ \subfigure[$d_t = \lambda$]{\resizebox{!}{10cm}		{\includegraphics{figuras/orto_barridoM_NM_dt1}}}}
	\caption{Medida de ortogonalidad para un sistema MIMO  con igual número de antenas transmisoras y receptoras para diferentes valores de $ASD$ y $d_t$.}
	\label{fig:ortoN}
\end{figure}


Podemos ver como los resultados en este caso son completamente diferentes que los obtenidos para los casos asimétricos donde $N = 2$ y $N = 4$. Recordemos que estamos estudiando escenarios con sistemas MIMO masivo, donde el número de antenas en un extremo de la comunicación es significativamente mayor que el número de antenas en el otro extremo, $M >> N$. En este caso, en el que $N = M$, no podemos aplicar las medidas que estamos estudiando pues no cumple el primer requisito que ha de tener un sistema MIMO masivo. Por ello, la conclusión que podemos extraer de este análisis es que no podremos lograr la ortogonalidad en matrices con dimensiones tan elevadas.

\subsection{Comparación de ortogonalidad entre matrices realistas y matrices i.i.d.}

En esta última sección compararemos la ortogonalidad entre las matrices que hemos generado de forma realista y las matrices i.i.d., con $M = 50$ antenas en el transmisor y diferente número $N$ de antenas en el receptor. 

\begin{figure}[htbp]
\centering
	\mbox{ \subfigure[$ASD = 10^\circ$]{\resizebox{!}{10cm}		{\includegraphics{figuras/orto_M50_iid_ASD10}}}}
	\mbox{ \subfigure[$d_t = \lambda$]{\resizebox{!}{10cm}		{\includegraphics{figuras/orto_M50_iid_dt1}}}}
	\caption{Medida de ortogonalidad para un sistema MIMO  con $50$ antenas transmisoras y diferente número de antenas receptoras para diferentes valores de $ASD$ y $d_t$.}
	\label{fig:ortoM50}
\end{figure}

Los parámetros de estas simulaciones han sido escogidos eligiendo un caso estándar en el transmisor: una distancia entre antenas de $d_t = \lambda$ y un ángulo de dispersión de las antenas transmisoras de $ASD = 10^{\circ}$. Como vemos en la figura (\ref{fig:ortoM50}), en todo momento la ortogonalidad de las matrices reales tienden a acercarse a las i.i.d a medida que la distancia entre antenas o el ángulo de dispersión aumenta, comportamiento que esperábamos pues es cuando se da la menor interferencia entre antenas. Además, la norma de las matrices realistas está siempre por encima de las ideales y tiende a acercarse al valor ideal a medida que mejoramos las condiciones (aumentamos la $d_t$ o $ASD$, como ya vimos en las secciones anteriores). 





















